trigger: none

pr:
  branches:
    include:
    - main

variables:
  solution: '**/*.sln'
  configuration: 'Debug'

stages:
- stage: Build
  displayName: 'PR Validation'

  jobs:
  - job: BuildTestWindows
    displayName: 'Build and Test on Windows'
    pool:
      vmImage: 'windows-latest'
    workspace:
      clean: all
    steps:
    - template: 'template-steps-build-test-windows.yml'
      parameters:
        solution: '$(solution)'
        configuration: '$(configuration)'
        nugetVersion: '1.0.0-test'

  - job: BuildTestUbuntu
    displayName: 'Build and Test on Ubuntu'
    pool:
      vmImage: 'ubuntu-latest'
    workspace:
      clean: all
    steps:
    - template: 'template-steps-build-test-ubuntu.yml'
      parameters:
        solution: '$(solution)'
        configuration: '$(configuration)'
        nugetVersion: '1.0.0-test'